.PHONY: help h install i enable e status s upgrade u cleanup c

help h:
	@echo "Available commands:"
	@echo "  install / i      - Installs runtime (pacman) then runs enable and status."
	@echo "  enable / e       - Adds Flathub remote if missing."
	@echo "  status / s       - Shows runtime version and configured remotes."
	@echo "  update / u      - Updates all apps and runtimes."
	@echo "  cleanup / c      - Removes unused runtimes."

install i:
	@echo "üõ† Installing runtime..."
	@sudo pacman -S --needed --noconfirm flatpak || { echo '‚ùå pacman failed'; exit 1; }
	@$(MAKE) -s enable status
	@echo "‚úÖ Done."
	@echo "-----------------------------------------------------------------------------------"

enable e:
	@echo "üõ∞ Adding Flathub remote (if missing)..."
	@flatpak remote-add --if-not-exists flathub https://flathub.org/repo/flathub.flatpakrepo
	@echo "‚úÖ Flathub configured."
	@echo "-----------------------------------------------------------------------------------"

status s:
	@echo "‚ÑπÔ∏è  runtime:"
	@flatpak --version 2>/dev/null || echo "not installed"
	@echo "-----------------------------"
	@echo "‚ÑπÔ∏è  remotes:"
	@flatpak remotes 2>/dev/null || true
	@echo "-----------------------------------------------------------------------------------"

update u:
	@echo "‚¨ÜÔ∏è  Updating apps and runtimes..."
	@flatpak update -y || true
	@echo "-----------------------------------------------------------------------------------"

cleanup c:
	@echo "üßπ Removing unused runtimes..."
	@flatpak uninstall -y --unused || true
	@echo "-----------------------------------------------------------------------------------"
