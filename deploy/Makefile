# Makefile for creating a deploy directory and its backup subdirectory
# URL: https://github.com/yourusername/yourrepo (–∑–∞–º–µ–Ω–∏ –Ω–∞ —Å–≤–æ–π)

MAIN_DEPLOY_DIR := $(HOME)/Deploys
BACKUP_DIR := backups
MEGA_MAKEFILE := $(HOME)/Configs/mega/Makefile
REMOTE_DEPLOY_DIR := /Deploys

.PHONY: help create mkdir

help:
	@echo "üì¶ Usage:"
	@echo "    make create <project_name>"
	@echo "üí° This will create:"
	@echo "    $(MAIN_DEPLOY_DIR)/<project_name>/backup"

mkdir:
	@if [ "$(words $(MAKECMDGOALS))" -ne 2 ]; then \
		echo "‚ùå Error: Exactly one project name is required."; \
		echo "üëâ Usage: make create <project_name>"; \
		exit 1; \
	fi; \
	PROJECT=$(word 2, $(MAKECMDGOALS)); \
	TARGET_DIR="$(MAIN_DEPLOY_DIR)/$$PROJECT/$(BACKUP_DIR)"; \
	echo "üìÅ Creating directory: $$TARGET_DIR" && \
	mkdir -p "$$TARGET_DIR" && \
	echo "‚úÖ Done: $$TARGET_DIR created" && \
	ls -la "$(MAIN_DEPLOY_DIR)/$$PROJECT"

sync:
    @if [ "$(words $(MAKECMDGOALS))" -ne 2 ]; then \
		echo "‚ùå Error: Exactly one project name is required."; \
		echo "üëâ Usage: make sync <project_name>"; \
		exit 1; \
	fi; \
	PROJECT=$(word 2, $(MAKECMDGOALS)); \
	LOCAL_PATH="$(MAIN_DEPLOY_DIR)/$$PROJECT"; \
	REMOTE_PATH="$(REMOTE_DEPLOY_DIR)/$$PROJECT"; \
	echo "üöÄ Calling MegaMakefile to sync:" && \
	echo "    LOCAL : $$LOCAL_PATH"; \
	echo "    REMOTE: $$REMOTE_PATH"; \
	$(MAKE) -f $(MEGA_MAKEFILE) sync "$$LOCAL_PATH" "$$REMOTE_PATH"

%:
	@:
