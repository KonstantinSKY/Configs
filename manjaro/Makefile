.PHONY: setup mirrors pacman-update install-yay enable-aur update

# Main target
setup: mirrors pacman-update install-yay yay-update enable-aur
	@echo "âœ… Manjaro i3 setup complete!"

# mirrors update
mirrors:
	@echo "ðŸ”„ Updating mirrors..."
	sudo pacman-mirrors --fasttrack && sudo pacman -Syy

# Full update with pamac
pacman-update:
	@echo "â¬†ï¸  Running full system upgrade..."
	sudo pacman -Syu --noconfirm

yay-update:
	@echo "â¬†ï¸  Updating AUR and system packages with yay..."
	@yay -Syu --noconfirm

# Ð’ÐºÐ»ÑŽÑ‡ÐµÐ½Ð¸Ðµ AUR (Ñ‚Ð¾Ð»ÑŒÐºÐ¾ ÐµÑÐ»Ð¸ Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·ÑƒÐµÑ‚ÑÑ pamac)
enable-aur:
	@echo "âš™ï¸  Enabling AUR support in pamac (if applicable)..."
	@if command -v pamac >/dev/null 2>&1; then \
		pamac config --enable-aur; \
	else \
		echo "â„¹ï¸  pamac not found, skipping AUR GUI enabling..."; \
	fi
# ÐžÐ±Ð½Ð¾Ð²Ð»ÐµÐ½Ð¸Ðµ AUR Ð¸ ÑÐ¸ÑÑ‚ÐµÐ¼Ð½Ñ‹Ñ… Ð¿Ð°ÐºÐµÑ‚Ð¾Ð² Ñ‡ÐµÑ€ÐµÐ· yay
update:
	@echo "â¬†ï¸  Full update of AUR and system packages via yay..."
	yay -Syyu --noconfirm --answerclean None --answerdiff None

	@echo "ðŸ§¹ Removing unused dependencies..."
	yay -Rns $$(pacman -Qtdq 2>/dev/null) || echo "âœ… No unused dependencies found"

	@echo "ðŸ§¼ Cleaning yay cache..."
	yay -Sc --noconfirm

	@echo "âœ… Update completed successfully!"

install-base:
	@echo "ðŸ“¦ Installing essential packages via yay..."
	yay -S --needed --noconfirm \
		base-devel \
		fzf \
		git \
		curl \
		wget \
		man-db \
		man-pages \
		file \
		which

	@echo "âœ… Base packages installed via yay."
